package com.xiii.libertycity.lac.check.checks.player.exploit;

import com.xiii.libertycity.lac.check.Category;
import com.xiii.libertycity.lac.check.Check;
import com.xiii.libertycity.lac.check.CheckInfo;
import io.github.retrooper.packetevents.event.impl.PacketPlayReceiveEvent;
import io.github.retrooper.packetevents.packetwrappers.play.in.updatesign.WrappedPacketInUpdateSign;

@CheckInfo(name = "Exploit C", category = Category.PLAYER)
public class ExploitC extends Check {

    public void onPacket(PacketPlayReceiveEvent packet) {
        if (packet.getPacketId() == -72) {
            WrappedPacketInUpdateSign p = new WrappedPacketInUpdateSign(packet.getNMSPacket());
            if ((p.getTextLines()).length > 200) {
                packet.setCancelled(true);
                fail("Texte de la pencarte invalide", "null");
            }
        }
        if (packet.getPacketId() == -72) {
            WrappedPacketInUpdateSign p = new WrappedPacketInUpdateSign(packet.getNMSPacket());
            if (p.getTextLines() == null) {
                packet.setCancelled(true);
                fail("Texte de la pencarte invalide", "null");
            }
        }
    }
}
